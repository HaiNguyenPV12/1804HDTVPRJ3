@model List<AirlinesReservationSystem.Models.Employee>



<h2>Employee - Add new Employee <a href="/arsadmin/employee" class="btn btn-warning" @*onclick="setModal('list')*@ ">Back to list</a></h2>
<div class="container" id="EmployeeAdd">

    @using (Html.BeginForm("employeeadd", "arsadmin",
        //    new AjaxOptions
        //    {
        //// UpdateTargetId = "modalBody",
        ////InsertionMode = InsertionMode.Replace,
        //OnBegin = "OnFormBegin",
        //        OnSuccess = "OnFormSubmit",
        //        HttpMethod = "Post"
        //    },
        FormMethod.Post,
        new { @id = "frmEmployeeAdd", @name = "frmEmployeeAdd" }))
    {
        @*@Html.AntiForgeryToken()
        @Html.ValidationSummary(false, "", new { @class = "text-danger" })*@
        <p class="text-danger" id="errorMessage"></p>
        <div id="EmployeeAddList" class="container">

        </div>
        <button type="button" class="btn btn-dark" id="btnAddAppend">Add another</button>
        <input type="submit" class="text-hide"/>
        <input type="button" value="Add this Employee" class="btn btn-success" id="btnEmployeeAdd" />
    }


</div>

@*<script src="~/Scripts/jquery-3.4.1.js"></script>*@
@*<script src="~/Scripts/jquery.validate.min.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript"></script>*@

<script>

    //function OnFormBegin() {
    //    $("#frmEmployeeAdd input").prop('disabled', true);
    //}

    //function OnFormSubmit(result, status, xhr) {
    //    if (result == "Success") {
    //        //$('#employeeList').load("/arsadmin/employeelist");
    //        setModal("list");
    //    } else {
    //        $('#employeeList').html(result);
    //    }
    //}

    $(document).ready(function () {
        var i = 0;
        appendForm();
        i = i + 1;
        function appendForm() {
            $.post("/arsadmin/employeeaddtemplate?index=" + i, function (result) {
                $("#EmployeeAddList").append(result);
            });
        }

        $("#btnEmployeeAdd").click(function () {
            if ($('#frmEmployeeAdd')[0].checkValidity()) {
                var form = $("#frmEmployeeAdd").serialize();

                $.post("/arsadmin/EmployeeAdd", form, function (result) {
                    $("#errorMessage").html(result);
                    if (result == "") {
                        window.location.href = "/arsadmin/Employee";
                    }
                });
            } else {
                $('#frmEmployeeAdd').find(':submit').click();
            }
        })

        $("#btnAddAppend").click(function () {
            appendForm();
            i = i + 1;
        })

    });
    //$('#EmployeeAdd').change(function () {
    //    $.validator.unobtrusive.parse("#frmEmployeeAdd");
    //});
</script>